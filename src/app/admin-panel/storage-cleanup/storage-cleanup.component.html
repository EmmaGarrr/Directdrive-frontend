<div class="google-drive-management">
  <div class="management-header">
    <h2><i class="fas fa-broom"></i> Storage Cleanup</h2>
    <div class="header-actions">
      <label class="toggle">
        <input type="checkbox" [(ngModel)]="useHardDelete">
        <span>Hard delete (wipe DB records)</span>
      </label>
      <button class="btn btn-danger" (click)="runCleanup()" [disabled]="loading">
        <i class="fas" [class.fa-spinner]="loading" [class.fa-spin]="loading" [class.fa-trash]="!loading"></i>
        {{ loading ? 'Running...' : 'Run Cleanup' }}
      </button>
    </div>
  </div>

  <div class="stats-overview" *ngIf="result">
    <div class="stat-card">
      <div class="stat-icon total"><i class="fas fa-info"></i></div>
      <div class="stat-content">
        <h3>{{ result.mode | uppercase }}</h3>
        <p>Reset Mode</p>
      </div>
    </div>
    <div class="stat-card">
      <div class="stat-icon storage"><i class="fab fa-google-drive"></i></div>
      <div class="stat-content">
        <h3>{{ result.gdrive.summary.deleted }}</h3>
        <p>GDrive Files Deleted</p>
        <span class="stat-detail">Errors: {{ result.gdrive.summary.errors }}</span>
      </div>
    </div>
    <div class="stat-card">
      <div class="stat-icon performance"><i class="fas fa-database"></i></div>
      <div class="stat-content">
        <h3>{{ result.files_marked_deleted }}</h3>
        <p>DB Files Marked Deleted</p>
        <span class="stat-detail">Hard deleted: {{ result.files_hard_deleted }}</span>
      </div>
    </div>
    <div class="stat-card">
      <div class="stat-icon quota"><i class="fas fa-layer-group"></i></div>
      <div class="stat-content">
        <h3>{{ result.batches_deleted }}</h3>
        <p>Batches Deleted</p>
      </div>
    </div>
  </div>

  <div *ngIf="result" class="account-details">
    <div class="detail-section">
      <h4>Per-Account Details</h4>
      <div class="detail-grid">
        <div class="detail-item" *ngFor="let kv of (result.gdrive.per_account | keyvalue)">
          <label>{{ kv.key }}</label>
          <span>Deleted: {{ kv.value.deleted }} | Errors: {{ kv.value.errors }} | {{ kv.value.message || 'OK' }}</span>
        </div>
      </div>
    </div>
  </div>

  <div class="loading-spinner" *ngIf="loading">
    <i class="fas fa-spinner fa-spin"></i>
    <p>Running cleanup...</p>
  </div>

  <div class="empty-state" *ngIf="!loading && !result">
    <i class="fas fa-broom"></i>
    <h3>No cleanup run yet</h3>
    <p>Select mode and click Run Cleanup to start.</p>
  </div>

  <div class="google-drive-management" style="margin-top: 1rem; padding: 1rem;">
    <h4>Logs</h4>
    <pre class="logs-block">{{ logs.join('\n') }}</pre>
  </div>
</div>


